loi_normale_plus(0.5)
install.packages("xlsx")
library("xlsx")
library(xlsx)
detach("package:xlsx", unload = TRUE)
library(xlsx)
df <- read.xlsx(xlsxFile = "C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/cars.xlsx", sheet = 1, skipEmptyRows = FALSE)
library(xlsx)
install.packages("xlsx")
library(xlsx)
library(xlsx)
detach("package:xlsx", unload = TRUE)
library(xlsx)
install.packages("xlsx")
library(xlsx)
install.packages("readxl")
library(readxl)
library(xlsx)
detach("package:xlsx", unload = TRUE)
library(xlsx)
df <- read.xlsx(xlsxFile = "C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/cars.xlsx", sheet = 1, skipEmptyRows = FALSE)
df <- readxl(xlsxFile = "C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/cars.xlsx", sheet = 1, skipEmptyRows = FALSE)
df <- read_excel("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/cars.xlsx")
df
detach("package:xlsx", unload = TRUE)
library(xlsx)
nrow(df)
ncol(df)
print(summary(df))
print(df[df["Marque"]=="Pontiac"])
print(df[df$Marque=="Pontiac",])
print(df[df$Marque=="Pontiac" & df&Type=="Sedan",])
ext=c(Marque, Modele, Type, Prix, Km)
print(df[df$Marque=="Pontiac",c(Marque, Modele, Type, Prix, Km)])
print(df[df$Marque=="Pontiac",c("Marque", "Modele", "Type", "Prix", "Km")])
print(df[df$Marque=="Pontiac" & df&Type=="Sedan",c("Marque", "Modele", "Type", "Prix", "Km")])
print(df[df$Marque=="Pontiac" & df$Type=="Sedan",c("Marque", "Modele", "Type", "Prix", "Km")])
cols=c("Marque", "Modele", "Type", "Prix", "Km")
print(df[df$Marque=="Pontiac",cols])
Marque = Pontiac et Prix > 20000 et Prix < 25000
print(df[df$Marque=="Pontiac" & df$Prix > 20000 & df$Prix < 25000, cols])
print(table(df$Type))
print(table(df[df$Marque==c("Pontiac", "Chevrolet")]))
print(table(df[df$Marque=="Pontiac" & df$Marque=="Chevrolet")]))
print(table(df[df$Marque=="Pontiac" & df$Marque=="Chevrolet"]))
print(table(df[df$Marque=="Pontiac" & df$Marque=="Chevrolet",]))
df[df$Marque=="Pontiac" & df$Marque=="Chevrolet",]
df[df$Marque=="Pontiac" & df$Marque=="Chevrolet",cols]
print(df[df$Marque=="Pontiac" & df$Marque=="Chevrolet",cols])
print(df[df$Marque=="Pontiac" & df$Prix > 20000 & df$Prix < 25000, cols])
print(df[df$Marque=="Pontiac" | df$Marque=="Chevrolet",cols])
print(table(df[df$Marque=="Pontiac" | df$Marque=="Chevrolet",]))
print(table(df[df$Marque=="Pontiac" | df$Marque=="Chevrolet",cols]))
print(df[df$Marque=="Pontiac" | df$Marque=="Chevrolet",cols])
df_pont_chev = df[df$Marque=="Pontiac" | df$Marque=="Chevrolet",cols]
print(table(df_pont_chev$Type))
#6
df_prix = order(df)
#6
df_prix = order(df$Prix)
print(df_prix)
#6
df_prix = order(df$Prix,15)
#6
print(head(order(df$Prix,15))
#6
print(head(order(df$Prix,15)))
#6
print(head(order(df$Prix,15)))
#6
print(head(df[order(df$Prix),]))
#6
print(head(df[order(df$Prix),cols],n=5))
#7
df_sed=df[df$Type=="Sedan",cols]
print(head(df_sed[order(df_sed$Prix),cols],n=5))
df
#8
print(table(df[df$HiFi=="oui" & df$Cuir == "oui"]))
#8
print(table(df[df$HiFi=="oui" & df$Cuir == "oui",]))
#8
print(table(df[df$HiFi=="oui" & df$Cuir == "oui",cols]))
#8
print(table(df[df$HiFi=="oui" & df$Cuir == "oui",cols]$Marque))
#9
print(table(df[df$Cuire=="oui",]$Marque) / table(df[df$HiFi=="oui",]$Marque))
#9
print(table(df[df$Cuir=="oui",]$Marque) / table(df[df$HiFi=="oui",]$Marque))
#9
t = table(df[df$Cuir=="oui" & df$HiFi == "oui",]$Marque)
#9
print(prop.t)
print(prop.table(t))
#9
t = table(df[df$Cuir=="oui" & df$HiFi == "oui",])
#9
t = ncol(df[df$Cuir=="oui" & df$HiFi == "oui",])
print(t/ncol(df))
t
#9
t = nrow(df[df$Cuir=="oui" & df$HiFi == "oui",])
t
print(t/ncol(df))
print(ncol(df)/t)
print(t/nrow(df))
t
print(t/nrow(df))
print(t/p)
#9
t = nrow(df[df$Cuir=="oui",])
p =  nrow(df[df$HiFi == "oui",])
print(t/p)
#9
cuir = nrow(df[df$Cuir=="oui",])
hifi =  nrow(df[df$HiFi == "oui",])
print(cuir/hifi)
hifi
print(prop.table(table(df$Cuir,df$HiFi),1)["oui","oui"])
print(hifi/cuir)
#10
print(tapply(df$Prix,df$Type,mean))
#11
print(tapply(df$Prix,df$Type,mean), decreasing=TRUE)
#11
print(tapply(sort(df$Prix,df$Type,mean), decreasing=TRUE))
#11
print(sort(tapply(df$Prix,df$Type,mean), decreasing=TRUE))
#12
print(tapply(df$Prix,df[df$Cuir=="oui"&df$HiFi=="oui",],mean))
#12
print(tapply(df$Prix,df[df$Cuir=="oui"&df$HiFi=="oui",c("Prix")],mean))
#12
print(tapply(df$Prix,INDEX = list(df$Cuir,df$HiFi),mean))
x=data(mtacrs)
x=data(mtcqrs)
x=data(,tcqrs)
x=data(mtcars)
x
head(mtcars)
class(mtcars)
quantil(mtcars$mpg)
quantile(mtcars$mpg)
quantile(mtcars$mpg, 75)
quantile(mtcars$mpg)$75%
class(quantile(mtcars$mpg))
quantile(mtcars$mpg)[3]
quantile(mtcars$mpg)[4]
}
intervalle_interquartile = function(x){
if (is.numeric(x) =! TRUE){
source("~/M2/R/seance_4/ex2.R")
intervalle_interquartile = function(x){
if (is.numeric(x) != TRUE){
print(NA)
break
}
return(quantile(x)[4]-quantile(x)[2])
}
sapply(mtcars,intervalle_interquartile)
intervalle_interquartile = function(x){
if (is.numeric(x) != TRUE){
return(NA)
}
return(quantile(x)[4]-quantile(x)[2])
}
sapply(mtcars,intervalle_interquartile)
intervalle_interquartile = function(x){
if (is.numeric(x) != TRUE){
return(NA)
}
return(quantile(x)[[4]]-quantile(x)[[2]])
}
sapply(mtcars,intervalle_interquartile)
sapply(iris,intervalle_interquartile)
iris
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t")
df_auto
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", header=T)
df_auto
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", h=T, sep="\t",)
df_auto
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt",  sep="\t",h=T)
df_auto
centre_reduire = function(x){
x-mean(x)/sd(x)
}
centre_reduire = function(x){
x-mean(x)/sd(x)
}
df_centre_reduire = function(df){
liste = lapply(df,centre_reduire())
}
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_centre_reduire(df_auto)
centre_reduire = function(x){
return(x-mean(x)/sd(x))
}
df_centre_reduire = function(df){
liste = lapply(df,centre_reduire())
}
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_centre_reduire(df_auto)
liste = lapply(df,centre_reduire)
centre_reduire = function(x){
return(x-mean(x)/sd(x))
}
df_centre_reduire = function(df){
liste = lapply(df,centre_reduire)
}
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_centre_reduire(df_auto)
df_num = lapply(df,class="integer")
df_num = lapply(df_auto,class="integer")
df_num = lapply(df_auto,class)=="integer"
centre_reduire = function(x){
x = (x-mean(x))/(sd(x))
return(x)
}
df_centre_reduire = function(df){
df_num = lapply(df,class)=="integer"
df[,df_num] = lapply(df_num,centre_reduire)
}
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_centre_reduire(df_auto)
test = lapply(df_auto, class)=="integer"
test
df_auto[,test]
centre_reduire = function(x){
x = (x-mean(x))/(sd(x))
return(x)
}
df_centre_reduire = function(df){
df_num = lapply(df,class)=="integer"
df[,df_num] = lapply(df_num[,df_num],centre_reduire)
}
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
centre_reduire = function(x){
x = (x-mean(x))/(sd(x))
return(x)
}
df_centre_reduire = function(df){
df_num = lapply(df,class)=="integer"
df[,df_num] = lapply(df_num[,df_num],centre_reduire)
return(df)
}
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_CR=df_centre_reduire(df_auto)
centre_reduire = function(x){
x = (x-mean(x))/(sd(x))
return(x)
}
df_centre_reduire = function(df){
df_num = lapply(df,class)=="integer"
df[,df_num] = lapply(df[,df_num],centre_reduire)
return(df)
}
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T)
df_auto
df_CR=df_centre_reduire(df_auto)
df_CR
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos_md.txt", sep="\t", h=T)
df_auto
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos.txt", sep="\t", h=T,row.names=1,dec=".")
df_auto
df_CR=df_centre_reduire(df_auto)
df_CR
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos_md.txt", sep="\t", h=T,row.names=1,dec=".")
df_auto
print(lapply(df_auto,is.na))
df_auto
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos_md.txt", sep="\t", h=T,row.names=1,dec=".", na.strings="?")
df_auto
print(lapply(df_auto,is.na))
print(lapply(df_auto,is.na)==T)
print(lapply(df_auto,is.na)==T)
print(lapply(dfna.omit)
print(lapply(dfna.omit))
print(lapply(df,na.omit))
print(df[lapply(df_auto,is.na),])
print(df[lapply(df_auto,is.na)==T,])
print(df[lapply(df_auto,is.na)=="T",])
print(df[lapply(df_auto,is.na)=="TRUE",])
print(lapply(df,length)))
function (object, ...)
print(length(lapply(df,na.omit)))
print(lapply(df,length))
print(class(lapply(df,na.omit)))
print(length(lapply(df,na.omit)))
print(length(lapply(df,na.omit))[[1]])
print((lapply(df,na.omit))[[1]])
sum(is.na(df_auto))
print((lapply(df,na.omit)))
print(lapply(df_auto,is.na))
print(class(lapply(df_auto,is.na)))
print(lapply(df_auto,is.na)[1])
sum(is.na(df_auto))
is.na(df_auto)
is.na(df_auto$CYL)
df_auto$CYL[,is.na(df_auto$CYL)]
df_auto$CYL[is.na(df_auto$CYL)]
x=df_auto$CYL
x
x[is.na(x)] = mean(x)
x
getmod=function(v){
uniqv=unique(v)
uniqv(which.max(tabulate(match(v,uniqv))))
}
getmod=function(v){
uniqv=unique(v)
uniqv(which.max(tabulate(match(v,uniqv))))
}
val_missing=function(x){
#si ya des na
if(sum(is.na(x))>0){
#si c'est num
if(is.numeric(x)==T){
replace(x, is.na(x)==T, mean(na.omit(x)))
return(x)
}else {
replace(x, is.na(x)==T, getmod(na.omit(x)))
return(x)
}
}
else{
return(x)
}
}
df_val_missing=function(df){
df = lapply(df,val_missing)
return(df)
}
df_no_missing = df_val_missing(df_auto)
getmod=function(v){
uniqv<-unique(v)
uniqv(which.max(tabulate(match(v,uniqv))))
}
df_no_missing = df_val_missing(df_auto)
x
df_auto
x=df_auto$FINITION
x
unique(x)
which.max(tabulate(match(v,unique(x))))
which.max(tabulate(match(x,unique(x))))
match(x,unique(x))
tabulate(match(x,unique(x)))
un=unique(x)
tabulate(match(x,un)
)
which.max(tabulate(match(x,un)))
un(which.max(tabulate(match(x,un))))
getmod=function(v){
uniqv=unique(v)
uniqv[which.max(tabulate(match(v,uniqv)))]
}
val_missing=function(x){
#si ya des na
if(sum(is.na(x))>0){
#si c'est num
if(is.numeric(x)==T){
x=replace(x, is.na(x)==T, mean(na.omit(x)))
return(x)
}else {
x=replace(x, is.na(x)==T, getmod(na.omit(x)))
return(x)
}
}
else{
return(x)
}
}
df_val_missing=function(df){
df = lapply(df,val_missing)
return(df)
}
df_no_missing = df_val_missing(df_auto)
df_no_missing
is.numeric(df_auto$PRIX)==T
is.numeric(df_auto$PRIX)
df_auto = read.table("C:/Users/pauli/Documents/M2/R/seance_4/Seance_4_Data/autos_md.txt", sep="\t", h=T,dec=".", na.strings="?")
df_auto
is.numeric(df_auto$FINITION)
getmod=function(v){
uniqv=unique(v)
uniqv[which.max(tabulate(match(v,uniqv)))]
}
val_missing=function(x){
#si ya des na
if(sum(is.na(x))>0){
#si c'est num
if(is.numeric(x)==T){
x=replace(x, is.na(x)==T, mean(na.omit(x)))
return(x)
}else {
print("pas num")
x=replace(x, is.na(x)==T, getmod(na.omit(x)))
return(x)
}
}
else{
return(x)
}
}
df_val_missing=function(df){
df = lapply(df,val_missing)
return(df)
}
df_no_missing = df_val_missing(df_auto)
df_no_missing
df_val_missing=function(df){
df = sapply(df,val_missing)
return(df)
}
df_no_missing = df_val_missing(df_auto)
df_no_missing
untar("Téléchargements/pls_2.8-1.tar.gz", list=T)
untar("C:/Users/pauli/Downloads/pls_2.8-1.tar.gz", list=T)
getwd()
untar("C:/Users/pauli/Downloads/pls_2.8-1.tar.gz")
untar("C:/Users/pauli/Downloads/mixOmics_6.22.0.tar")
untar("C:/Users/pauli/Downloads/mixOmics_6.22.0.tar.gz")
getdir
getdir()
ls
dir
getdir
getwd
ggplot(rescol, aes(x=X1, y=X2, col = y, fill = y)) +
stat_ellipse(geom = "polygon", col= "black", alpha =0.5)+
geom_point(shape=21, col="black")
setwd("C:/Users/pauli/Documents/M2/R/projet/code/PLSDA_R_Package/")
source("code/nipals.r")
source("code/scale.r")
source("code/predict.r")
fit <- function(formula, data,
ncomp = 2,
max.iter = 100,
tol = 1e-06)
{
#formula au bon type
if(plyr::is.formula(formula)==F){
stop("formula must be R formula !")
}
if (any(colSums(!is.na(data)) == 0) | any(rowSums(!is.na(data)) == 0 )){
stop("some rows or columns are entirely missing. ",
"Remove those before running pca.", call. = FALSE)
}
#Récupération des X et Y
X <- as.matrix(model.matrix(formula, data = data)[,-1])
y <- as.factor(model.response(model.frame(formula, data = data)))
#si data est a standardiser
if ((mean(apply(X,2,mean))>abs(1)) || (sum(sqrt(apply(X,2,var))) != ncol(X))){
X <- plsda.scale(X)
}
ydum <- plsda.dummies(y)
nipals.res <- plsda.nipals(X=X, y=ydum, ncomp = ncomp , max.iter = max.iter, tol = tol)
XYloadings <- cbind(nipals.res$Xloadings,as.data.frame(y))
###faire les plots ici
return(nipals.res)
}
data<-data(iris)
formula<-Species~.
test = fit(formula, data)
data
data<-data(iris)
data
data<-read_excel("seeds_dataset.xls")
formula <- seed~.
test = fit(formula, data)
test$Coeffs
coeffs<-test$Coeffs
X <- as.matrix(X)
X <- as.matrix(data)
B <- coeffs[-1,]
B
Cte <- matrix(rep(coeffs[1,], each=nrow(X)), nrow(X), ncol(B))
Cte
Cte <- matrix(rep(B, each=nrow(X)), nrow(X), ncol(B))
Cte <- matrix(rep(B[1,], each=nrow(X)), nrow(X), ncol(B))
Cte
source("code/nipals.r")
test$Coeffs
source("~/M2/R/projet/code/PLSDA_R_Package/code/predict.R")
Cte <- matrix(rep(B[1,], each=nrow(X)), nrow(X), ncol(B))
Cte
X
# Prediction
Y.hat <- X %*% B + Cte
#Récupération des X et Y
X <- as.matrix(model.matrix(formula, data = data)[,-1])
X
X <- as.matrix(X)
B
Cte <- matrix(rep(B[1,], each=nrow(X)), nrow(X), ncol(B))
# Prediction
Y.hat <- X %*% B + Cte
Y.hat
# SoftMax
Y.hat <- t(apply(Y.hat, 1, function(x) { exp(x) / sum(exp(x)) }))
Y.hat
